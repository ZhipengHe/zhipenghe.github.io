<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Bypassing Image Anti-Hotlinking with Nginx Reverse Proxy | Zhipeng "Zippo" He - 何志鹏 </title> <meta name="author" content="Zhipeng He"> <meta name="description" content="A guide on implementing an Nginx reverse proxy to solve image hotlinking issues in RSS feeds. Learn how to bypass anti-hotlinking protection while maintaining ethical usage, including server-side caching, dynamic DNS resolution, and automated URL conversion techniques."> <meta name="keywords" content="Adversarial Attacks, Robust ML, Explainable AI"> <meta property="og:site_name" content='Zhipeng "Zippo" He - 何志鹏'> <meta property="og:type" content="article"> <meta property="og:title" content='Zhipeng "Zippo" He - 何志鹏 | Bypassing Image Anti-Hotlinking with Nginx Reverse Proxy'> <meta property="og:url" content="https://zhipenghe.me/blog/2025/Bypassing-Image-Anti-Hotlinking-with-Nginx/"> <meta property="og:description" content="A guide on implementing an Nginx reverse proxy to solve image hotlinking issues in RSS feeds. Learn how to bypass anti-hotlinking protection while maintaining ethical usage, including server-side caching, dynamic DNS resolution, and automated URL conversion techniques."> <meta property="og:image" content="/assets/img/posts/june-15-pm0404.png"> <meta property="og:locale" content="en"> <meta name="twitter:card" content="summary"> <meta name="twitter:title" content="Bypassing Image Anti-Hotlinking with Nginx Reverse Proxy"> <meta name="twitter:description" content="A guide on implementing an Nginx reverse proxy to solve image hotlinking issues in RSS feeds. Learn how to bypass anti-hotlinking protection while maintaining ethical usage, including server-side caching, dynamic DNS resolution, and automated URL conversion techniques."> <meta name="twitter:image" content="/assets/img/posts/june-15-pm0404.png"> <script type="application/ld+json">
    {
        "author":
        {
            "@type": "Person",
            "name": "Zhipeng He"
        },
        "url": "https://zhipenghe.me/blog/2025/Bypassing-Image-Anti-Hotlinking-with-Nginx/",
        "@type": "BlogPosting",
        "description": "A guide on implementing an Nginx reverse proxy to solve image hotlinking issues in RSS feeds. Learn how to bypass anti-hotlinking protection while maintaining ethical usage, including server-side caching, dynamic DNS resolution, and automated URL conversion techniques.",
        "headline": "Bypassing Image Anti-Hotlinking with Nginx Reverse Proxy",
        
        "name": "Zhipeng He",
        "@context": "https://schema.org"
    }
  </script> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link defer href="/assets/css/bootstrap-toc.min.css?6f5af0bb9aab25d79b2448143cbeaa88" rel="stylesheet"> <link rel="shortcut icon" href="/assets/img/favicon.ico?882998a3e8a752412150c8837f1ee3bd"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://zhipenghe.me/blog/2025/Bypassing-Image-Anti-Hotlinking-with-Nginx/"> <script src="/assets/js/theme.js?a81d82887dd692e91686b43de4542f18"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Zhipeng</span> "Zippo" He 何志鹏 </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories </a> </li> <li class="nav-item "> <a class="nav-link" href="https://slides.zhipenghe.me/" rel="external nofollow noopener" target="_blank">slides </a> </li> <li class="nav-item "> <a class="nav-link" href="/vitae/">vitae </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="row"> <div class="col-sm-9"> <div class="post"> <header class="post-header"> <h1 class="post-title">Bypassing Image Anti-Hotlinking with Nginx Reverse Proxy</h1> <p class="post-meta"> Created on June 15, 2025 </p> <p class="post-tags"> <a href="/blog/2025"> <i class="fa-solid fa-calendar fa-sm"></i> 2025 </a>   ·   <a href="/blog/tag/linux"> <i class="fa-solid fa-hashtag fa-sm"></i> Linux</a>   <a href="/blog/tag/nginx"> <i class="fa-solid fa-hashtag fa-sm"></i> Nginx</a>   <a href="/blog/tag/glance"> <i class="fa-solid fa-hashtag fa-sm"></i> Glance</a>   <a href="/blog/tag/proxy"> <i class="fa-solid fa-hashtag fa-sm"></i> Proxy</a>   ·   <a href="/blog/category/webdev"> <i class="fa-solid fa-tag fa-sm"></i> WebDev</a>   <a href="/blog/category/self-hosted"> <i class="fa-solid fa-tag fa-sm"></i> Self-hosted</a> </p> </header> <article class="post-content"> <div id="markdown-content"> <div class="text-center mt-3"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/posts/june-15-pm0404-480.webp 480w,/assets/img/posts/june-15-pm0404-800.webp 800w,/assets/img/posts/june-15-pm0404-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/posts/june-15-pm0404.png" class="img-fluid rounded z-depth-1 w-100" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="caption" style="font-style: italic;"> <b>15 JUNE PM 04:04</b> </div> <blockquote class="block-danger"> <h5 id="️-usage-warning">⚠️ Usage Warning</h5> <p>This technique should only be used for legitimate aggregation of publicly available RSS content. Do not use it for bypassing paywalls, accessing private content, or commercial redistribution.</p> </blockquote> <p>When setting up my <a href="https://github.com/glanceapp/glance" rel="external nofollow noopener" target="_blank">Glance</a> dashboard to display feeds from various content platforms, I ran into a frustrating problem: images weren’t loading. Instead of the expected thumbnails and cover images that make a dashboard visually engaging, I was seeing broken image placeholders scattered throughout my feeds.</p> <hr> <h2 id="the-problem">The Problem</h2> <p>Opening the browser’s developer console revealed the culprit immediately. Error messages like this were appearing repeatedly:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>GET https://cdn.example.com/images/photo.jpg 403 (Forbidden)
Failed to load resource: the server responded with a status of 403 (Forbidden)
</code></pre></div></div> <p>These <code class="language-plaintext highlighter-rouge">403 Forbidden</code> errors were blocking external images from RSS feeds, yet the same URLs worked when opened directly in the browser. The image servers’ referrer policy of <code class="language-plaintext highlighter-rouge">strict-origin-when-cross-origin</code> was causing them to reject requests coming from my domain, triggering anti-hotlinking protection.</p> <h3 id="understanding-the-root-cause">Understanding the Root Cause</h3> <p>The problem stemmed from how content platforms protect their images from unauthorized use. Most platforms implement anti-hotlinking protection by checking the <code class="language-plaintext highlighter-rouge">Referer</code> header in image requests. Here’s what was happening:</p> <ol> <li> <strong>Referrer checking:</strong> When my dashboard requested an image, the CDN server would examine the <code class="language-plaintext highlighter-rouge">Referer</code> header.</li> <li> <strong>Domain mismatch:</strong> Since requests came from my dashboard’s domain rather than the platform’s own website, the server treated them as unauthorized.</li> <li> <strong>Inconsistent blocking:</strong> Different CDN subdomains had varying levels of protection, explaining why some images loaded while others didn’t.</li> </ol> <p>This was particularly maddening because the same images would load perfectly when I opened them directly in a new browser tab, but they’d fail when embedded in my dashboard. The RSS feeds themselves parsed correctly with all the text content intact, but without the visual elements, my dashboard looked broken.</p> <hr> <h2 id="cloudflare-workers-from-perfect-solution-to-dead-end">Cloudflare Workers: From Perfect Solution to Dead End</h2> <p>My first instinct was to reach for Cloudflare Workers—it used to be the perfect solution for this kind of proxy problem. I could write a simple function to intercept image requests, fetch them with the proper headers, and return them with CORS headers enabled. The edge computing model would even provide great performance with global distribution.</p> <p>However, when I checked Cloudflare’s current <a href="https://www.cloudflare.com/en-au/terms/" rel="external nofollow noopener" target="_blank">Terms of Service</a> (last updated December 3, 2024), I discovered a clause in section 2.2.1 that stopped me in my tracks:</p> <blockquote> <p>“(j) use the Services to provide a virtual private network or other similar proxy services.”</p> </blockquote> <p>This restriction effectively rules out using Workers for image proxying, as it would fall under “similar proxy services.” While this clause may have existed before, Cloudflare has been increasingly strict about enforcing it.</p> <p>The risk simply wasn’t worth it. Getting my account suspended would affect not just this dashboard project, but potentially other services I was running on the Cloudflare. I needed a solution that was both effective and compliant with current service terms.</p> <hr> <h2 id="self-hosted-nginx-reverse-proxy-the-solution">Self-Hosted Nginx Reverse Proxy: The Solution</h2> <p>Since I was already running Glance on my own VPS, I decided to implement a reverse proxy using Nginx on the same server. This approach would give me complete control while avoiding any third-party terms of service violations. The beauty of this solution is that it uses my existing infrastructure without requiring additional hosting costs.</p> <h3 id="setting-up-server-side-caching">Setting Up Server-Side Caching</h3> <p>I added a server-side cache to the Nginx configuration to improve performance and reduce load on the external CDNs. This cache stores images for 14 days (336 hours), ensuring that frequently viewed images load instantly on subsequent visits.</p> <div class="language-nginx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># /etc/nginx/nginx.conf</span>
<span class="k">http</span> <span class="p">{</span>
    <span class="c1">##</span>
    <span class="c1"># Cache Settings</span>
    <span class="c1">##</span>
    <span class="kn">proxy_cache_path</span> <span class="n">/var/cache/nginx/images</span>
                     <span class="s">levels=1:2</span>
                     <span class="s">keys_zone=images:10m</span>
                     <span class="s">max_size=1g</span>
                     <span class="s">inactive=336h</span>
                     <span class="s">use_temp_path=off</span><span class="p">;</span>

    <span class="c1"># ... rest of http config</span>
    <span class="kn">include</span> <span class="n">/etc/nginx/sites-enabled/*</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div> <h3 id="configuring-the-image-proxy">Configuring the Image Proxy</h3> <p>Then I configured the image proxy in my site configuration. The key insight was using dynamic DNS resolution to handle multiple CDN providers through a single proxy path. Here’s the configuration I added to my existing server block:</p> <div class="language-nginx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># /etc/nginx/sites-available/dashboard.example.com</span>
<span class="k">server</span> <span class="p">{</span>
    <span class="kn">server_name</span> <span class="s">dashboard.example.com</span><span class="p">;</span>

    <span class="c1"># DNS resolver for dynamic proxy</span>
    <span class="kn">resolver</span> <span class="mf">127.0</span><span class="s">.0.53</span> <span class="s">valid=300s</span><span class="p">;</span>
    <span class="kn">resolver_timeout</span> <span class="s">5s</span><span class="p">;</span>

    <span class="c1"># Existing Glance application</span>
    <span class="kn">location</span> <span class="n">/</span> <span class="p">{</span>
        <span class="kn">proxy_pass</span> <span class="s">http://localhost:8080</span><span class="p">;</span>
        <span class="c1"># ... existing headers</span>
    <span class="p">}</span>

    <span class="c1"># Image proxy for external CDNs</span>
    <span class="kn">location</span> <span class="p">~</span> <span class="sr">^/img-proxy/([^/]+)/(.*)$</span> <span class="p">{</span>
        <span class="kn">set</span> <span class="nv">$backend_host</span> <span class="nv">$1</span><span class="p">;</span>
        <span class="kn">set</span> <span class="nv">$backend_path</span> <span class="nv">$2</span><span class="p">;</span>

        <span class="c1"># Enable proxy caching</span>
        <span class="kn">proxy_cache</span> <span class="s">images</span><span class="p">;</span>
        <span class="kn">proxy_cache_valid</span> <span class="mi">200</span> <span class="s">336h</span><span class="p">;</span>
        <span class="kn">proxy_cache_key</span> <span class="s">"</span><span class="nv">$backend_host$backend_path</span><span class="s">"</span><span class="p">;</span>
        <span class="kn">proxy_cache_use_stale</span> <span class="s">error</span> <span class="s">timeout</span> <span class="s">updating</span> <span class="s">http_500</span> <span class="s">http_502</span> <span class="s">http_503</span> <span class="s">http_504</span><span class="p">;</span>

        <span class="c1"># Proxy to external CDN</span>
        <span class="kn">proxy_pass</span> <span class="s">https://</span><span class="nv">$backend_host</span><span class="n">/</span><span class="nv">$backend_path</span><span class="p">;</span>

        <span class="c1"># Essential headers for bypassing anti-hotlinking</span>
        <span class="kn">proxy_set_header</span> <span class="s">Referer</span> <span class="s">"https://</span><span class="nv">$backend_host</span><span class="n">/"</span><span class="p">;</span>
        <span class="kn">proxy_set_header</span> <span class="s">User-Agent</span> <span class="s">"Mozilla/5.0</span> <span class="s">(Windows</span> <span class="s">NT</span> <span class="mf">10.0</span><span class="p">;</span> <span class="kn">Win64</span><span class="p">;</span> <span class="kn">x64</span><span class="s">)</span> <span class="s">AppleWebKit/537.36"</span><span class="p">;</span>
        <span class="kn">proxy_set_header</span> <span class="s">Host</span> <span class="nv">$backend_host</span><span class="p">;</span>

        <span class="c1"># SSL configuration</span>
        <span class="kn">proxy_ssl_verify</span> <span class="no">off</span><span class="p">;</span>
        <span class="kn">proxy_ssl_server_name</span> <span class="no">on</span><span class="p">;</span>

        <span class="c1"># Add CORS and cache headers</span>
        <span class="kn">add_header</span> <span class="s">Access-Control-Allow-Origin</span> <span class="s">"*"</span> <span class="s">always</span><span class="p">;</span>
        <span class="kn">add_header</span> <span class="s">Cache-Control</span> <span class="s">"public,</span> <span class="s">max-age=1209600"</span> <span class="s">always</span><span class="p">;</span>
        <span class="kn">add_header</span> <span class="s">X-Cache-Status</span> <span class="nv">$upstream_cache_status</span> <span class="s">always</span><span class="p">;</span>

        <span class="c1"># Basic protection against abuse</span>
        <span class="kn">valid_referers</span> <span class="s">none</span> <span class="s">blocked</span> <span class="s">dashboard.example.com</span><span class="p">;</span>
        <span class="kn">if</span> <span class="s">(</span><span class="nv">$invalid_referer</span><span class="s">)</span> <span class="p">{</span>
            <span class="kn">return</span> <span class="mi">403</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="c1"># ... existing SSL configuration</span>
<span class="p">}</span>
</code></pre></div></div> <p>The magic happens in the regex location block. By capturing the hostname and path in separate variables, I could support any external CDN domain through my proxy. The URL transformation is clean:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Original:  https://cdn.platform.com/images/photo.jpg
Proxied:   https://dashboard.example.com/img-proxy/cdn.platform.com/images/photo.jpg
</code></pre></div></div> <p>After setting up the configuration, I created the cache directory:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo mkdir</span> <span class="nt">-p</span> /var/cache/nginx/images
<span class="nb">sudo chown</span> <span class="nt">-R</span> www-data:www-data /var/cache/nginx/images
<span class="nb">sudo chmod</span> <span class="nt">-R</span> 755 /var/cache/nginx/images
<span class="nb">sudo </span>nginx <span class="nt">-t</span> <span class="o">&amp;&amp;</span> <span class="nb">sudo </span>systemctl reload nginx
</code></pre></div></div> <h3 id="automating-image-url-conversion">Automating Image URL Conversion</h3> <p>With the Nginx proxy in place, I needed a way to automatically convert external image URLs in my Glance dashboard. Rather than manually updating every RSS feed configuration, I wrote a client-side script that would handle the conversion transparently.</p> <p>I added this JavaScript to my Glance configuration as a custom <code class="language-plaintext highlighter-rouge">.js</code> file:</p> <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="nf">function </span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// CDN domains that commonly implement anti-hotlinking</span>
  <span class="kd">const</span> <span class="nx">BLOCKED_DOMAINS</span> <span class="o">=</span> <span class="p">[</span><span class="dl">"</span><span class="s2">cdn.example.com</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">images.platform.com</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">static.service.net</span><span class="dl">"</span><span class="p">];</span>

  <span class="kd">function</span> <span class="nf">convertExternalImages</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">selector</span> <span class="o">=</span> <span class="nx">BLOCKED_DOMAINS</span><span class="p">.</span><span class="nf">map</span><span class="p">((</span><span class="nx">domain</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="s2">`img[src*="</span><span class="p">${</span><span class="nx">domain</span><span class="p">}</span><span class="s2">"]:not([data-converted])`</span><span class="p">).</span><span class="nf">join</span><span class="p">(</span><span class="dl">"</span><span class="s2">,</span><span class="dl">"</span><span class="p">);</span>

    <span class="nb">document</span><span class="p">.</span><span class="nf">querySelectorAll</span><span class="p">(</span><span class="nx">selector</span><span class="p">).</span><span class="nf">forEach</span><span class="p">((</span><span class="nx">img</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">try</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">originalSrc</span> <span class="o">=</span> <span class="nx">img</span><span class="p">.</span><span class="nx">src</span><span class="p">;</span>
        <span class="kd">const</span> <span class="nx">proxySrc</span> <span class="o">=</span> <span class="nx">originalSrc</span><span class="p">.</span><span class="nf">replace</span><span class="p">(</span><span class="sr">/https</span><span class="se">?</span><span class="sr">:</span><span class="se">\/\/([^/]</span><span class="sr">+</span><span class="se">)\/</span><span class="sr">/g</span><span class="p">,</span> <span class="dl">"</span><span class="s2">/img-proxy/$1/</span><span class="dl">"</span><span class="p">);</span>

        <span class="nx">img</span><span class="p">.</span><span class="nx">src</span> <span class="o">=</span> <span class="nx">proxySrc</span><span class="p">;</span>
        <span class="nx">img</span><span class="p">.</span><span class="nf">setAttribute</span><span class="p">(</span><span class="dl">"</span><span class="s2">data-converted</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">true</span><span class="dl">"</span><span class="p">);</span>
        <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Converting:</span><span class="dl">"</span><span class="p">,</span> <span class="nx">originalSrc</span><span class="p">,</span> <span class="dl">"</span><span class="s2">→</span><span class="dl">"</span><span class="p">,</span> <span class="nx">proxySrc</span><span class="p">);</span>
      <span class="p">}</span> <span class="k">catch </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nf">error</span><span class="p">(</span><span class="dl">"</span><span class="s2">Failed to convert image:</span><span class="dl">"</span><span class="p">,</span> <span class="nx">error</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">});</span>
  <span class="p">}</span>

  <span class="k">if </span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">readyState</span> <span class="o">!==</span> <span class="dl">"</span><span class="s2">loading</span><span class="dl">"</span><span class="p">)</span> <span class="p">{</span>
    <span class="nf">convertExternalImages</span><span class="p">();</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nb">document</span><span class="p">.</span><span class="nf">addEventListener</span><span class="p">(</span><span class="dl">"</span><span class="s2">DOMContentLoaded</span><span class="dl">"</span><span class="p">,</span> <span class="nx">convertExternalImages</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="c1">// Check for new images every 3 seconds</span>
  <span class="nf">setInterval</span><span class="p">(</span><span class="nx">convertExternalImages</span><span class="p">,</span> <span class="mi">3000</span><span class="p">);</span>
<span class="p">})();</span>
</code></pre></div></div> <p>The script maintains a list of problematic CDN domains and only processes images from those sources. When it detects a blocked image, it uses regex to rebuild the URL to route through my proxy. This focused approach avoids wasting resources on images that already load fine.</p> <h3 id="results-and-testing">Results and Testing</h3> <p>After implementing both components, I tested the setup:</p> <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Test in browser console</span>
<span class="nf">fetch</span><span class="p">(</span><span class="dl">"</span><span class="s2">/img-proxy/cdn.platform.com/images/test.jpg</span><span class="dl">"</span><span class="p">)</span>
  <span class="p">.</span><span class="nf">then</span><span class="p">((</span><span class="nx">response</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Status:</span><span class="dl">"</span><span class="p">,</span> <span class="nx">response</span><span class="p">.</span><span class="nx">status</span><span class="p">,</span> <span class="nx">response</span><span class="p">.</span><span class="nx">statusText</span><span class="p">))</span>
  <span class="p">.</span><span class="k">catch</span><span class="p">((</span><span class="nx">error</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nf">error</span><span class="p">(</span><span class="dl">"</span><span class="s2">Error:</span><span class="dl">"</span><span class="p">,</span> <span class="nx">error</span><span class="p">));</span>
</code></pre></div></div> <p>The test returned <code class="language-plaintext highlighter-rouge">Status: 200 OK</code>, confirming the proxy was working correctly with proper CORS headers.</p> <p>With the proxy confirmed working, the dashboard transformation was impressive. Images that had been broken placeholders now loaded correctly throughout my feeds. RSS content became visually rich with thumbnails and cover images that made the dashboard much more engaging.</p> <p>The JavaScript automatically converts problematic image URLs as new RSS content loads. When fresh content appears, any images from blocked domains are quickly converted to use the proxy route. The 14-day cache configuration means once an image loads through the proxy, subsequent views are instant.</p> <h3 id="verifying-cache-performance">Verifying Cache Performance</h3> <p>To verify that the caching was working as intended, I checked the Nginx cache directory:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Count cached files</span>
<span class="nb">sudo </span>find /var/cache/nginx/images <span class="nt">-type</span> f | <span class="nb">wc</span> <span class="nt">-l</span>

<span class="c"># Check cache size</span>
<span class="nb">sudo du</span> <span class="nt">-sh</span> /var/cache/nginx/images
</code></pre></div></div> <p>The cache was working as intended, with files being created and deleted as expected.</p> <hr> <h2 id="responsible-usage">Responsible Usage</h2> <p>This solution requires thoughtful implementation to respect both technical constraints and content platforms. The 14-day caching configuration significantly reduces load on source CDNs—an image that might be viewed dozens of times only generates a single upstream request.</p> <p>The referrer validation prevents unauthorized access. The <code class="language-plaintext highlighter-rouge">valid_referers</code> directive restricts proxy usage to requests originating from my dashboard domain, ensuring it can’t be exploited as an open relay by external users.</p> <p>When implementing similar solutions, consider the scope and purpose of your usage to maintain ethical standards and avoid potential service violations.</p> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/Jekyll-LiveReload-vs-WebSocket-Secure/">Jekyll LiveReload vs WebSocket Secure: A Protocol Compatibility Issue</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/Code-is-Cheap/">Code is Cheap. Show me the Prompts</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/Surviving-without-VS-Code-Remote-SSH/">Surviving without VS Code Remote SSH</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/Docker-API-Exposure-Linux/">Docker API Exposure via Tailscale VPN - Linux Setup Guide</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/The-DS_Store-Strikes-Back/">The .DS_Store Strikes Back: Finder Edition</a> </li> <div id="giscus_thread" style="max-width: 950px; margin: 0 auto;"> <script>
      let giscusTheme = determineComputedTheme();
      let giscusAttributes = {
        src: 'https://giscus.app/client.js',
        'data-repo': 'ZhipengHe/zhipenghe.github.io',
        'data-repo-id': 'R_kgDOJKOkyw',
        'data-category': 'Announcements',
        'data-category-id': 'DIC_kwDOJKOky84CrTTz',
        'data-mapping': 'title',
        'data-strict': '1',
        'data-reactions-enabled': '1',
        'data-emit-metadata': '0',
        'data-input-position': 'bottom',
        'data-theme': giscusTheme,
        'data-lang': 'en',
        crossorigin: 'anonymous',
        async: '',
      };

      let giscusScript = document.createElement('script');
      Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value));
      document.getElementById('giscus_thread').appendChild(giscusScript);
    </script> <noscript>Please enable JavaScript to view the <a href="http://giscus.app/?ref_noscript" rel="external nofollow noopener" target="_blank">comments powered by giscus.</a> </noscript> </div> </div> </div> <div class="col-sm-3"> <nav id="toc-sidebar" class="sticky-top"></nav> </div> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 <i class="fas fa-code"></i> with <i class="fas fa-heart"></i> by Zhipeng "Zippo" He 何志鹏. Last updated: November 17, 2025. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script defer src="/assets/js/bootstrap-toc.min.js?c82ff4de8b0955d6ff14f5b05eed7eb6"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-212459996-1"></script> <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
      dataLayer.push(arguments);
    }
    gtag('js', new Date());

    gtag('config', 'UA-212459996-1');
  </script> <script defer src="/assets/js/google-analytics-setup.js"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> </body> </html>